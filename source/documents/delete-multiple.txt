.. _compass-bulk-delete:

=========================
Delete Multiple Documents
=========================

.. facet::
   :name: genre
   :values: tutorial

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

You can perform bulk delete operations on multiple documents in Compass
by using the :guilabel:`Delete Documents` modal. Performing delete with
the :guilabel:`Delete Documents` modal helps you visualize deletes 
to your data before you apply them.

About this Task
---------------

Deleting documents is a permanent action and cannot not be undone. 
Validate documents in the :guilabel:`Preview` of the 
:guilabel:`Delete Documents` modal before confirming the 
delete operation.

Before you Begin
----------------

The :guilabel:`Delete Documents` modal is available starting
in Compass version ``1.5.X``. For instructions on updating or installing
the latest Compass version, see :ref:`download-install`. 

Steps
-----

.. procedure::
   :style:  normal

   .. step:: Apply a query filter

      From the :guilabel:`Documents` tab, input a query into the 
      :guilabel:`Query bar`. The filter criteria of the query specified 
      applies to the documents in the :guilabel:`Delete Documents` 
      modal. If you need to delete all documents in a collection, 
      leave the :guilabel:`Query bar` blank.

   .. step:: Open the delete documents modal

      On the :guilabel:`Documents` tab, click the :icon-lg:`Trash` 
      :guilabel:`Delete` button to display the 
      :guilabel:`Delete Documents` modal. The following 
      table summarizes the :abbr:`UI (User Interface)` of the modal:

      .. list-table::
         :widths: 40 60
         :header-rows: 1

         * - UI Element
           - Description

         * - :guilabel:`Query`
           - Any filter criteria specified on the 
             :guilabel:`Query Bar` applies to the 
             :guilabel:`Delete Documents` modal.
             To update the :guilabel:`Query`, exit the 
             :guilabel:`Delete Documents` modal and modify the 
             query in the :guilabel:`Query Bar`.
         * - :guilabel:`Export`
           - Prompts the :guilabel:`Export Delete Query To Language`
             modal. The :guilabel:`Export Delete Query To Language` 
             modal allows you to convert the delete query
             to a supported driver language.
         * - :guilabel:`Preview`
           - A preview of the documents that will be deletion.

   .. step:: (Optional) Export the :guilabel:`Delete`

      You can export and convert the :guilabel:`Delete` query to a 
      supported driver language using the :guilabel:`Export` button on 
      the :guilabel:`Delete Documents` modal. 

      a. On the :guilabel:`Delete Documents` modal, click 
         :guilabel:`Export`. The 
         :guilabel:`Export Delete Query To Language` modal displays with
         the delete syntax populated under :guilabel:`My Delete Query`.

      #. Select a programming language by clicking the drop-down under 
         :guilabel:`Exported Delete Query`. The converted delete syntax
         displays under the :guilabel:`Exported Delete Query` header.

      #. (Optional) Include import statements 
         Click the :guilabel:`Include Import Statements` checkbox to 
         include the required import statements for the selected 
         programming language.

         .. include:: /includes/fact-supported-language-exports.rst

      #. Click the :icon-lg:`Copy` icon to copy the converted syntax.

      #. Click the :guilabel:`Close` button.

   .. step:: Delete your documents

      a. Click :guilabel:`Delete Documents`.
      #. Click the red :guilabel:`Delete Documents` button to confirm
         the operation.

      Compass applies the :guilabel:`Delete` to the documents
      within the :guilabel:`Filter` expression.

Example
-------

The following example uses the 
:ref:`sample_mflix dataset <sample-data>`. 

This example updates the ``tomatoes.viewer.numReviews`` and 
``tomatoes.viewer.meter`` fields with the Compass 
:guilabel:`Update Documents` modal.

Apply a filter in the :guilabel:`Query Bar` to filter movies which
have a ``year`` of ``1917``.

.. code-block:: javascript

   { 'year' : 1917 }

Click the :icon-lg:`Edit` :guilabel:`Update` button, the :guilabel:`Update Documents` 
modal displays.

In the :guilabel:`Update` text box, paste the following syntax:

.. code-block:: javascript

   { 
      $inc: { "tomatoes.viewer.numReviews" : 1}, 
      $set: { "tomatoes.viewer.meter" : 99 } 
   }

This syntax:

- :manual:`Increments </reference/operator/update/inc>` the 
  ``tomatoes.viewer.numReviews`` field by ``1``.
- :manual:`Sets </reference/operator/update/set>` the 
  ``tomatoes.viewer.meter`` field to ``99``.

The :guilabel:`Preview` section populates with sample documents
affected by the update query.

To view the updates to the :guilabel:`numReviews` 
and :guilabel:`meter` fields:

- Click the :icon-fa5:`angle-right` arrow icon next to 
  :guilabel:`tomatoes`. 
- Click the :icon-fa5:`angle-right` arrow icon next to 
  :guilabel:`viewer`.

Click the :guilabel:`Update Documents` button to update the collection's
data.

Learn More
----------

- :ref:`compass-bulk-delete`
- :ref:`saved-favorite-query-view`
